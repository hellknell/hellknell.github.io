{"version":3,"file":"js/962.41f93b05.js","mappings":"yJAMA,MAAMA,EAAUC,EAAAA,EAAMC,OAAO,CACzBC,QAASC,yBACTC,QAAS,MAMbL,EAAQM,aAAaN,QAAQO,KAAIC,IAC7BA,EAAOC,QAAQ,gBAAkB,iCACjC,IAAIC,EAAQC,KAAKC,MAAMC,aAAaC,QAAQ,iBAAcC,EAE1D,OADAP,EAAOC,QAAQC,MAAQA,GAAOA,MACvBF,CAAM,IACdQ,IACCC,QAAQD,MAAM,kBAAoBA,GAC3BE,QAAQC,OAAOH,MAK1BhB,EAAQM,aAAac,SAASb,KAC1Ba,IACI,IAAIC,EAAMD,EAASE,KAanB,MAZiB,QAAbD,EAAIE,OACJC,EAAAA,EAAMC,OAAO,YAAa,CAAC,GAC3BC,EAAAA,EAAaV,MAAM,CACfW,QAAS,KACTC,YAAa,gBAEjBC,EAAAA,EAAOC,KAAK,WAGG,kBAART,IACPA,EAAMA,EAAMV,KAAKC,MAAMS,GAAOA,GAE3BA,CAAG,IAEdL,IACIC,QAAQc,IAAI,QAASf,GACrB,MAAMI,EAAWJ,EAAMI,SACjBY,EAASZ,EAASY,OAQxB,OAPe,MAAXA,IAEAf,QAAQc,IAAI,kBACZP,EAAAA,EAAMC,OAAO,YAAa,CAAC,GAC3BC,EAAAA,EAAaV,MAAM,CAAEY,YAAa,aAClCC,EAAAA,EAAOC,KAAK,WAETZ,QAAQC,OAAOH,EAAM,IAIpC,K,mbCUA,MAAMiB,GAAQC,EAAAA,EAAAA,KAAI,GACZC,GAAQD,EAAAA,EAAAA,KAAI,GACZE,GAAYC,EAAAA,EAAAA,IAAS,CACzBC,OAAQ,GACRf,KAAM,KAYFgB,EAAOA,KACXtB,QAAQc,IAAI,OAAO,EAEfS,EAAYA,KAChBb,EAAAA,GAAQM,QAAQ,QAClBA,EAAQQ,OAAM,CAAI,EAEZC,GAAYR,EAAAA,EAAAA,IAAI,IACtB,IAAIS,GAAOT,EAAAA,EAAAA,KAAI,GACf,MAAML,GAASe,EAAAA,EAAAA,MACTC,EAAWA,KACf7C,EAAAA,EAAQ8C,IAAI,yBAA0B,CACpCC,OAAQ,CACNT,OAAQF,EAAUE,UAEnBU,MAAK3B,IACW,QAAbA,EAAIE,MACNG,EAAAA,EAAaO,QAAQ,CAACN,QAAS,KAAMC,YAAa,gBAClDe,EAAKF,OAAQ,EACbQ,KAEAtB,EAAAA,GAAQX,MAAMK,EAAI6B,IACpB,GACA,EAGJ,IAAIC,EAAgBC,MAAOC,EAAOZ,IAClB,KAAVA,EACKvB,QAAQC,OAAO,UACZ,oBAAoBmC,KAAKb,GAG9BvB,QAAQqC,UAFNrC,QAAQC,OAAO,WAK1B,MAAMqC,EAAQ,CACZlB,OAAQ,CACN,CAACmB,UAAWN,EAAeO,QAAS,YAKlCT,EAAiBA,KACrB,MAAMU,EAAaC,aAAY,KACzBlB,EAAUD,MAAQ,EACpBC,EAAUD,SAEVoB,cAAcF,GACdhB,EAAKF,OAAQ,EACbC,EAAUD,MAAQ,GACpB,GACC,IAAK,EAGJqB,EAAQ,WACZ3B,EAAMM,OAAQ,EACXR,EAAQQ,MACTf,EAAAA,EAAaV,MAAM,CAACW,QAAS,KAAMC,YAAa,cAGlDC,EAAOC,KAAK,KACZ9B,EAAAA,EAAQ+D,KAAK,sBAAuB3B,GAAWY,MAAK3B,IACjC,QAAbA,EAAIE,MAENC,EAAAA,EAAMC,OAAO,YAAaJ,GAAKC,MAC/BK,EAAAA,GAAQM,QAAQ,QAChBA,EAAQQ,OAAM,EACdZ,EAAOC,KAAK,MAGZH,EAAAA,GAAQX,MAAMK,EAAI6B,IACpB,IAEJ,E,y1DCvJA,MAAMc,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://web/./src/util/request.js","webpack://web/./src/views/LoginView.vue","webpack://web/./src/views/LoginView.vue?5755"],"sourcesContent":["import axios from 'axios'\r\nimport store from \"@/store\";\r\nimport {notification} from \"ant-design-vue\";\r\nimport router from \"@/router\";\r\n\r\n// 创建可一个新的axios对象\r\nconst request = axios.create({\r\n    baseURL: process.env.VUE_APP_BASEURL,   // 后端的接口地址  ip:port\r\n    timeout: 30000                          // 30s请求超时\r\n})\r\n\r\n// request 拦截器\r\n// 可以自请求发送前对请求做一些处理\r\n// 比如统一加token，对请求参数统一加密\r\nrequest.interceptors.request.use(config => {\r\n    config.headers['Content-Type'] = 'application/json;charset=utf-8';\r\n    let token = JSON.parse(localStorage.getItem('member')) || undefined;\r\n    config.headers.token = token?.token;\r\n    return config\r\n}, error => {\r\n    console.error('request error: ' + error) // for debug\r\n    return Promise.reject(error)\r\n});\r\n\r\n// response 拦截器\r\n// 可以在接口响应后统一处理结果\r\nrequest.interceptors.response.use(\r\n    response => {\r\n        let res = response.data;\r\n        if (res.code === '401') {\r\n            store.commit(\"setMember\", {});\r\n            notification.error({\r\n                message: '错误',\r\n                description: '登录已过期，请重新登录',\r\n            })\r\n            router.push('/login')\r\n        }\r\n        // 兼容服务端返回的字符串数据\r\n        if (typeof res === 'string') {\r\n            res = res ? JSON.parse(res) : res\r\n        }\r\n        return res;\r\n    },\r\n    error => {\r\n        console.log('返回错误：', error);\r\n        const response = error.response;\r\n        const status = response.status;\r\n        if (status === 401) {\r\n            // 判断状态码是401 跳转到登录页\r\n            console.log(\"未登录或登录超时，跳到登录页\");\r\n            store.commit(\"setMember\", {});\r\n            notification.error({ description: \"未登录或登录超时\" });\r\n            router.push('/login');\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nexport default request","<template>\n  <div class=\"main\" style=\"display: flex;align-items: center;justify-content: center;min-width:800px;height: 100%\">\n\n    <a-row\n        style=\"width: 60%;height: 50%;display: flex;align-items: center;background: rgba(243,255,255,0.2);backdrop-filter: blur(2px);border: 1px solid #eee;border-radius: 10px\">\n      <a-col :span=\"16\" :offset=\"4\" style=\"position: relative;display: flex;align-items: center;flex-direction: column\">\n\n        <h1 style=\"text-align:center;font-weight: bold\">12306\n          <rocket-two-tone style=\"fontSize:30px \"/>\n          售票平台\n        </h1>\n        <a-form\n            :model=\"loginForm\"\n            name=\"basic\"\n            :wrapper-col=\"{ span: 24 }\"\n            autocomplete=\"off\"\n            :rules=\"rules\"\n        >\n          <a-form-item has-feedback\n                       :wrapper-col=\"{span:24 }\"\n                       name=\"mobile\"\n          >\n            <a-input size=\"large\" placeholder=\"请输入手机号\" v-model:value=loginForm.mobile\n            />\n          </a-form-item>\n          <a-form-item\n              :wrapper-col=\"{span: 24 }\"\n              name=\"code\"\n\n          >\n            <a-input size=\"large\" placeholder=\"请输入验证码\"\n                     v-model:value=loginForm.code>\n              <template #addonAfter>\n                <div style=\"font-size: 11px;color:dodgerblue\" v-if=\"flag\">{{ countdown }}秒后重新获取</div>\n                <a v-else @click=\"sendCode\">获取验证码</a>\n              </template>\n            </a-input>\n          </a-form-item>\n          <a-form-item\n              :wrapper-col=\"{span: 24 }\"\n          >\n            <mi-captcha theme-color=\"#2F9688\"\n                        border-color=\"#2F9688\"\n                        box-shadow-color=\"#2F9688\"\n                        height=50\n                        wight=20\n                        :maskClosable=\"true\"\n                        :mask=\"true\"\n                        @onSuccess=\"OnSuccess\"\n                        @onInit=\"init\"\n/>\n          </a-form-item>\n          <a-form-item :wrapper-col=\"{ span: 24 } \">\n            <a-button type=\"primary\" html-type=\"submit\" style=\"width: 100%;\" @click=login>登录</a-button>\n          </a-form-item>\n        </a-form>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n<script setup>\n// 引入\nimport {message, notification} from 'ant-design-vue';\nimport {useRouter} from \"vue-router\";\n// 使用\nimport request from \"@/util/request\";\nimport {reactive, ref} from 'vue';\nimport store from \"@/store\";\nconst success=ref(false)\nconst flag1 = ref(false)\nconst loginForm = reactive({\n  mobile: '',\n  code: ''\n})\n// const random=ref(''+Math.random());\n// const params = reactive({\n//   verify:\n//       {code: null}\n// })\n// const initAfter = (res) => {\n//   if (res == '200') {\n//     localStorage.setItem('mi-captcha-key', res?.data)\n//     params.verify.code = res?.data\n//   }\nconst init = () => {\n  console.log('init')\n}\nconst OnSuccess = () => {\n  message.success('验证成功');\nsuccess.value=true\n}\nconst countdown = ref(60);\nlet flag = ref(false)\nconst router = useRouter()\nconst sendCode = () => {\n  request.get(\"member/member/sendCode\", {\n    params: {\n      mobile: loginForm.mobile\n    }\n  }).then(res => {\n    if (res.code === '200') {\n      notification.success({message: '提示', description: '验证码发送成功，请查收'});\n      flag.value = true\n      startCountdown()\n    } else {\n      message.error(res.msg)\n    }\n  })\n\n}\nlet validatePhone = async (_rule, value) => {\n  if (value === '') {\n    return Promise.reject('请输入手机号');\n  } else if (!/^1[3456789]\\d{9}$/.test(value)) {\n    return Promise.reject('手机号格式错误')\n  }\n  return Promise.resolve();\n}\n\nconst rules = {\n  mobile: [\n    {validator: validatePhone, trigger: 'change'}\n  ]\n};\n\n/* 倒计时函数 */\nconst startCountdown = () => {\n  const intervalId = setInterval(() => {\n    if (countdown.value > 0) {\n      countdown.value--;\n    } else {\n      clearInterval(intervalId);\n      flag.value = false\n      countdown.value = 60;\n    }\n  }, 1000)\n}\n\nconst login = function () {\n  flag1.value = true\n  if(success.value){\n    notification.error({message: '提示', description: '请先完成图形验证'})\n    return\n  }\n  router.push('/')\n  request.post('member/member/login', loginForm).then(res => {\n    if (res.code === \"200\") {\n\n      store.commit('setMember', res?.data)\n      message.success(\"登录成功\")\n      success.value=false\n      router.push('/')\n\n    } else {\n      message.error(res.msg)\n    }\n  })\n}\n</script>\n<style scoped>\n.silde_box {\n  margin: 0 auto;\n  width: 100px;\n  height: 200px;\n}\n\n.main {\n  background-image: url(\"../assets/imgs/bg.png\");\n  background-repeat: no-repeat;\n  background-size: cover;\n}\n\n</style>","import script from \"./LoginView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LoginView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=d15d69f4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d15d69f4\"]])\n\nexport default __exports__"],"names":["request","axios","create","baseURL","process","timeout","interceptors","use","config","headers","token","JSON","parse","localStorage","getItem","undefined","error","console","Promise","reject","response","res","data","code","store","commit","notification","message","description","router","push","log","status","success","ref","flag1","loginForm","reactive","mobile","init","OnSuccess","value","countdown","flag","useRouter","sendCode","get","params","then","startCountdown","msg","validatePhone","async","_rule","test","resolve","rules","validator","trigger","intervalId","setInterval","clearInterval","login","post","__exports__"],"sourceRoot":""}