{"version":3,"file":"js/64.1dcf6080.js","mappings":"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","sources":["webpack://web/./src/util/request.js","webpack://web/./src/views/main/PassengerView.vue","webpack://web/./src/views/main/PassengerView.vue?3cb8"],"sourcesContent":["import axios from 'axios'\r\nimport store from \"@/store\";\r\nimport {notification} from \"ant-design-vue\";\r\nimport router from \"@/router\";\r\n\r\n// 创建可一个新的axios对象\r\nconst request = axios.create({\r\n    baseURL: process.env.VUE_APP_BASEURL,   // 后端的接口地址  ip:port\r\n    timeout: 30000                          // 30s请求超时\r\n})\r\n\r\n// request 拦截器\r\n// 可以自请求发送前对请求做一些处理\r\n// 比如统一加token，对请求参数统一加密\r\nrequest.interceptors.request.use(config => {\r\n    config.headers['Content-Type'] = 'application/json;charset=utf-8';\r\n    let token = JSON.parse(localStorage.getItem('member')) || undefined;\r\n    config.headers.token = token?.token;\r\n    return config\r\n}, error => {\r\n    console.error('request error: ' + error) // for debug\r\n    return Promise.reject(error)\r\n});\r\n\r\n// response 拦截器\r\n// 可以在接口响应后统一处理结果\r\nrequest.interceptors.response.use(\r\n    response => {\r\n        let res = response.data;\r\n        if (res.code === '401') {\r\n            store.commit(\"setMember\", {});\r\n            notification.error({\r\n                message: '错误',\r\n                description: '登录已过期，请重新登录',\r\n            })\r\n            router.push('/login')\r\n        }\r\n        // 兼容服务端返回的字符串数据\r\n        if (typeof res === 'string') {\r\n            res = res ? JSON.parse(res) : res\r\n        }\r\n        return res;\r\n    },\r\n    error => {\r\n        console.log('返回错误：', error);\r\n        const response = error.response;\r\n        const status = response.status;\r\n        if (status === 401) {\r\n            // 判断状态码是401 跳转到登录页\r\n            console.log(\"未登录或登录超时，跳到登录页\");\r\n            store.commit(\"setMember\", {});\r\n            notification.error({ description: \"未登录或登录超时\" });\r\n            router.push('/login');\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nexport default request","<template>\r\n  <div>\r\n    <div style=\"text-align: left\">\r\n      <a-space direction=\"horizontal\" :size=\"10\" align=\"start\" style=\"text-align: left\">\r\n        <a-button type=\"primary\" @click=\"handlePage()\">刷新</a-button>\r\n        <a-button type=\"primary\" danger @click=\"add\">添加乘车人</a-button>\r\n      </a-space>\r\n    </div>\r\n    <a-table :data-source=\"dataSource\" :columns=\"columns\" :loading=\"loading\" :pagination=pagination @change=\"onChange\"\r\n             @resizeColumn=\"handleResizeColumn\">\r\n      <template #bodyCell=\"{ column, record }\">\r\n        <template v-if=\"column.dataIndex==='type'\">\r\n          <div\r\n              v-for=\"item in [{code:'1',desc:'成人',color:'#f50'},{code:'2',desc:'儿童',color: '#2db7f5'},{code:'3',desc:'学生',color:'#108ee9'}]\"\r\n              :key=\"item.code\">\r\n            <a-tag :color=item.color v-if=\"item.code===record.type\">{{ item.desc }}</a-tag>\r\n          </div>\r\n        </template>\r\n        <template v-if=\"column.dataIndex === 'operation'\">\r\n          <a-space :size=\"15\">\r\n            <a-popconfirm title=\"确定要删除吗\" @confirm=\"del(record.id)\" ok-text=\"确认\"\r\n                          cancel-text=\"取消\">\r\n              <template #icon>\r\n                <question-circle-outlined style=\"color: red\"/>\r\n              </template>\r\n              <a style=\"color: red\" href=\"#\">删除</a>\r\n            </a-popconfirm>\r\n            <a-button size=\"small\" @click=\"save(record)\" type=\"primary\">\r\n              <template #icon>\r\n                <EditOutlined/>\r\n              </template>\r\n            </a-button>\r\n          </a-space>\r\n        </template>\r\n      </template>\r\n    </a-table>\r\n    <!--    <a-pagination size=\"small\" :total=\"50\" />-->\r\n    <a-modal\r\n        v-model:visible=\"visible\"\r\n        title=\"乘车人信息\"\r\n        @ok=\"handleOk\"\r\n        ok-text=\"确认\"\r\n        cancel-text=\"取消\"\r\n        keyboard\r\n    >\r\n      <a-form :model=\"passenger\" ref=\"formRef\" label-align=\"right\" :rules=\"rules\" :label-col=\"{span:6}\"\r\n              :wrapper-col=\"{span:18,offset:0}\">\r\n        <a-form-item has-feedback label=\"姓名\" name=\"name\">\r\n          <a-input v-model:value=\"passenger.name\"/>\r\n        </a-form-item>\r\n        <a-form-item has-feedback label=\"乘客类型\" name=\"type\">\r\n          <a-select v-model:value=\"passenger.type\">\r\n            <a-select-option v-for=\"item in [{code:'1',desc:'成人'},{code:'2',desc:'儿童'},{code:'3',desc:'学生'}]\"\r\n                             :key=\"item.code\" :value=\"item.code\">\r\n              {{ item.desc }}\r\n            </a-select-option>\r\n\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item has-feedback label=\"身份证号\" name=\"idCard\">\r\n          <a-input v-model:value=\"passenger.idCard\"/>\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {onMounted, reactive, ref} from \"vue\";\r\nimport request from \"@/util/request\";\r\nimport {message, notification} from \"ant-design-vue\"\r\nimport {EditOutlined, QuestionCircleOutlined} from '@ant-design/icons-vue';\r\nimport '@/assets/js/enum'\r\nconst loading = ref(false)\r\nconst pagination = ref({\r\n  total: 0,\r\n  pageSize: 10,\r\n  current: 1\r\n})\r\nconst save = (data) => {\r\n  passenger.value = JSON.parse(JSON.stringify(data))\r\n  visible.value = true\r\n}\r\nconst add = () => {\r\n  visible.value = true\r\n  passenger.value = {}\r\n}\r\nconst dataSource = ref([])\r\nconst columns = ref([\r\n  {\r\n    title: '会员id',\r\n    dataIndex: 'memberId',\r\n    resizable: true\r\n  },\r\n  {\r\n    title: '姓名',\r\n    dataIndex: 'name',\r\n    resizable: true\r\n  },\r\n  {\r\n    title: '身份证',\r\n    dataIndex: 'idCard',\r\n    resizable: true\r\n  },\r\n  {\r\n    title: '旅客类型',\r\n    dataIndex: 'type',\r\n    resizable: true\r\n  },\r\n  {\r\n    title: '操作',\r\n    dataIndex: 'operation'\r\n  },\r\n])\r\nlet validatePass = async (_rule, value) => {\r\n  if (value === '') {\r\n    return Promise.reject('请输入身份证号');\r\n  } else {\r\n    //利用正则表达式判断身份证号是否符合规则\r\n    let reg = /(^\\d{15}$)|(^\\d{18}$)|(^\\d{17}(\\d|X|x)$)/;\r\n    if (reg.test(value) === false) {\r\n      return Promise.reject('身份证号格式错误');\r\n    }\r\n  }\r\n  return Promise.resolve();\r\n};\r\nconst rules = reactive({\r\n  name: [{required: true, message: '请输入姓名', trigger: 'blur'}],\r\n  type: [{required: true, message: '请输入乘客类型', trigger: 'blur'}],\r\n  idCard: [{trigger: 'blur', validator: validatePass}]\r\n})\r\n// const del = (record) => {\r\n//   // request.del(\"/passenger/del?id=\" + record.id.then(res => {\r\n//   //\r\n//   // }))\r\n// }\r\nconst onChange = (page) => {\r\n  console.log(page)\r\n  handlePage({\r\n    pageNum: page.current,\r\n    pageSize: page.pageSize\r\n  })\r\n}\r\nconst visible = ref(false);\r\nconst passenger = ref(\r\n    {\r\n      name: '',\r\n      type: '',\r\n      idCard: ''\r\n    }\r\n)\r\nonMounted(() => {\r\n  handlePage({\r\n    pageNum: pagination.value.current,\r\n    pageSize: pagination.value.pageSize\r\n  })\r\n})\r\nconst handlePage = (param) => {\r\n  if (!param) {\r\n    param = {\r\n      pageNum: 1,\r\n      pageSize: 4\r\n    }\r\n  }\r\n  loading.value = true\r\n  request.get(\"member/passenger/query-list\", {\r\n    params: {\r\n      pageNum: param.pageNum,\r\n      pageSize: param.pageSize\r\n    }\r\n  }).then(res => {\r\n    loading.value = false\r\n    if (res) {\r\n      dataSource.value = res.data?.list\r\n      pagination.value.current = res.data?.pageNum\r\n      pagination.value.total = res.data?.total\r\n    }\r\n  })\r\n}\r\nconst formRef = ref()\r\n// const showModal = () => {\r\n//   visible.value = true;\r\n// };\r\nconst handleResizeColumn = (w, col) => {\r\n  col.width = w\r\n}\r\nconst del = (record) => {\r\n  request.delete(\"member/passenger/del/\" + record).then(res => {\r\n    if (res.success) {\r\n      message.success(\"删除成功\")\r\n      handlePage()\r\n    } else {\r\n      notification.error({description: res.message})\r\n    }\r\n  })\r\n}\r\nconst handleOk = () => {\r\n  formRef.value.validate().then(() => {\r\n    request.post(\"member/passenger/save\", passenger.value\r\n    ).then(res => {\r\n      if (res.code === '200') {\r\n        message.success({content: \"操作成功\"})\r\n        visible.value = false;\r\n        passenger.value = {}\r\n        handlePage({\r\n          pageNum: pagination.value.current,\r\n          pageSize: pagination.value.pageSize\r\n        })\r\n      } else {\r\n        notification.error({message: res.msg})\r\n      }\r\n    })\r\n  }).catch(err => {\r\n    console.log('error', err);\r\n    notification.error({message: '请检查输入是否正确'})\r\n  })\r\n\r\n}\r\n</script>\r\n<style scoped>\r\n</style>","import script from \"./PassengerView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PassengerView.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["request","axios","create","baseURL","process","timeout","interceptors","use","config","headers","token","JSON","parse","localStorage","getItem","undefined","error","console","Promise","reject","response","res","data","code","store","commit","notification","message","description","router","push","log","status","loading","ref","pagination","total","pageSize","current","save","passenger","value","stringify","visible","add","dataSource","columns","title","dataIndex","resizable","validatePass","async","_rule","reg","test","resolve","rules","reactive","name","required","trigger","type","idCard","validator","onChange","page","handlePage","pageNum","onMounted","param","get","params","then","list","formRef","handleResizeColumn","w","col","width","del","record","delete","success","handleOk","validate","post","content","msg","catch","err","__exports__"],"sourceRoot":""}