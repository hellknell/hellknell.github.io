"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[199],{8073:function(e,a,t){t(4114);var l=t(8355),d=t(5129),n=t(5108),i=t(9325);const u=l.A.create({baseURL:"http://api.example.com",timeout:3e4});u.interceptors.request.use((e=>{e.headers["Content-Type"]="application/json;charset=utf-8";let a=JSON.parse(localStorage.getItem("member"))||void 0;return e.headers.token=a?.token,e}),(e=>(console.error("request error: "+e),Promise.reject(e)))),u.interceptors.response.use((e=>{let a=e.data;return"401"===a.code&&(d.A.commit("setMember",{}),n.A.error({message:"错误",description:"登录已过期，请重新登录"}),i.A.push("/login")),"string"===typeof a&&(a=a?JSON.parse(a):a),a}),(e=>{console.log("返回错误：",e);const a=e.response,t=a.status;return 401===t&&(console.log("未登录或登录超时，跳到登录页"),d.A.commit("setMember",{}),n.A.error({description:"未登录或登录超时"}),i.A.push("/login")),Promise.reject(e)})),a.A=u},6199:function(e,a,t){t.r(a),t.d(a,{default:function(){return V}});t(4114);var l=t(6768),d=t(144),n=t(4232),i=t(8073),u=t(5108),r={__name:"station-select",props:["info","modelValue","width"],emits:["update:modelValue"],setup(e,{emit:a}){const t=a,u=e,r=(0,d.KR)([]),o=(0,d.KR)(""),v=(0,d.KR)("");(0,l.wB)((()=>u.modelValue),(()=>{o.value=u.modelValue}),{immediate:!0}),(0,l.wB)((()=>u.info),(()=>{v.value=u.info}),{immediate:!0});const s=(0,d.KR)(u.width||"100%");s.value&&(s.value=s.value+"px");const c=(e,a)=>a.label.toLowerCase().indexOf(e.toLowerCase())>=0,p=e=>{t("update:modelValue",e);let a=r.value.filter((a=>a.code===e))[0];null===a&&(a={}),t("change",a)};return(0,l.sV)((()=>{let e=SESSION.get(SESSION_ALL_TRAIN)||[];console.log("读取到了缓存:",r),Tool.isNotEmpty(e)?(r.value=e,console.log(r.value)):i.A.get("member/station/query-station").then((e=>{e.success&&(r.value=e.data,SESSION.set(SESSION_ALL_TRAIN,e.data))}))})),(e,a)=>{const t=(0,l.g2)("a-select-option"),d=(0,l.g2)("a-select");return(0,l.uX)(),(0,l.Wv)(d,{value:o.value,"onUpdate:value":a[0]||(a[0]=e=>o.value=e),style:(0,n.Tr)("width:"+s.value),"show-search":"",filterOption:c,"allow-clear":"",placeholder:v.value,onChange:p},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.value,((e,a)=>((0,l.uX)(),(0,l.Wv)(t,{value:e.name,key:a,label:e.name+e.namePinyin+e.namePy},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.name)+" | "+(0,n.v_)(e.namePinyin)+"--"+(0,n.v_)(e.namePy),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["value","style","placeholder"])}}};const o=r;var v=o,s=t(9325);const c={class:"ticket"},p={class:"search",style:{width:"100%"}},y={key:0},b={style:{"text-align":"center"}},m={style:{"white-space":"nowrap","text-align":"center"}},k={key:1,style:{"text-align":"center"}},w={key:2,style:{width:"max-content"}},g=(0,l.Lk)("div",{style:{"text-align":"center"}},"to",-1),R={key:3,style:{width:"max-content"}},_=(0,l.Lk)("div",{style:{"text-align":"center"}},"~",-1),F={key:0},x={style:{"text-align":"center"}},h=(0,l.Lk)("br",null,null,-1),S={style:{"text-align":"center","white-space":"nowrap"}},f={key:1,st:"","--":"",yle:"text-align: center"},z={key:0},I={style:{"text-align":"center"}},C=(0,l.Lk)("br",null,null,-1),E={style:{"text-align":"center","white-space":"nowrap"}},P={key:1,style:{"text-align":"center"}},T={key:6,style:{width:"max-content"}},L={key:0},U={key:1},A={key:0},N={style:{"text-align":"center"}},X={style:{"white-space":"nowrap","text-align":"center"}},K=(0,l.Lk)("br",null,null,-1),O={key:1,style:{"text-align":"center"}};var M={__name:"TicketView",setup(e){const a=(0,d.KR)(!1);let t=(0,d.KR)({id:void 0,date:void 0,trainCode:void 0,start:void 0,startPinyin:void 0,startTime:void 0,startIndex:void 0,end:void 0,endPinyin:void 0,endTime:void 0,endIndex:void 0,ydz:void 0,ydzPrice:void 0,edz:void 0,edzPrice:void 0,rw:void 0,rwPrice:void 0,yw:void 0,ywPrice:void 0,createTime:void 0,updateTime:void 0});const r=(0,d.KR)([]),o=(0,d.KR)({total:0,current:1,pageSize:10}),M=(e,a)=>{a.width=e};let Q=(0,d.KR)(!1);const V=[{title:"车次编号",dataIndex:"trainCode",key:"trainCode",resizable:!0,width:100},{title:"车站",dataIndex:"start",key:"start",width:100,resizable:!0},{title:"出发站序",dataIndex:"startIndex",key:"startIndex",width:100,resizable:!0},{title:"时间",dataIndex:"startTime",width:100,key:"startTime",resizable:!0},{title:"历时",dataIndex:"time",width:100,resizable:!0},{title:"到达站序",dataIndex:"endIndex",width:100,resizable:!0},{title:"一等座余票",dataIndex:"ydz",width:150,key:"ydz",resizable:!0},{title:"二等座余票",width:150,dataIndex:"edz",key:"edz",resizable:!0},{title:"软卧余票",dataIndex:"rw",key:"rw",resizable:!0,width:150},{title:"硬卧余票",dataIndex:"yw",width:100,key:"yw",resizable:!0},{title:"操作",dataIndex:"operation",width:200}],Y=e=>{SESSION.set(SESSINO_ORDER,e),s.A.push("/order")},W=(0,d.KR)({date:void 0,start:void 0,end:void 0}),D=e=>{Tool.isEmpty(W.value.date)?u.A.error({description:"请输入出发日期"}):Tool.isEmpty(W.value.start)?u.A.error({description:"请输入出发站"}):Tool.isEmpty(W.value.end)?u.A.error({description:"请输入目的站"}):(SESSION.set(SESSINO_TICKET_PARAMS,W.value),e||(e={pageNum:1,pageSize:o.value.pageSize}),Q.value=!0,i.A.get("member/daily-ticket/query-list",{params:{pageNum:e.pageNum,pageSize:e.pageSize,date:W.value.date,start:W.value.start,end:W.value.end}}).then((a=>{Q.value=!1,a.success?(r.value=a.data.list,o.value.current=e.pageNum,o.value.total=a.data.total):u.A.error({description:a.msg})})))},j=e=>{o.value.pageSize=e.pageSize,D({pageNum:e.current,pageSize:e.pageSize})};return(0,l.sV)((()=>{let e=SESSION.get(SESSINO_TICKET_PARAMS)||{};Tool.isNotEmpty(e)&&(W.value=e,D({pageNum:1,pageSize:o.value.pageSize}))})),(e,i)=>{const u=(0,l.g2)("a-date-picker"),s=(0,l.g2)("a-button"),q=(0,l.g2)("a-space"),H=(0,l.g2)("a-table"),B=(0,l.g2)("a-form-item"),J=(0,l.g2)("a-input"),G=(0,l.g2)("a-time-picker"),Z=(0,l.g2)("a-form"),$=(0,l.g2)("a-modal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",c,[(0,l.Lk)("div",p,[(0,l.bF)(q,{style:{width:"100%",display:"flex","justify-content":"flex-start"}},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"a1",placeholder:"请输入日期","value-format":"YYYY-MM-DD",value:W.value.date,"onUpdate:value":i[0]||(i[0]=e=>W.value.date=e)},null,8,["value"]),(0,l.bF)(v,{class:"a2",width:"150",info:"请输入出发站",value:W.value.start,"onUpdate:value":i[1]||(i[1]=e=>W.value.start=e)},null,8,["value"]),(0,l.bF)(v,{class:"a3",width:"150",info:"请输入到达站",value:W.value.end,"onUpdate:value":i[2]||(i[2]=e=>W.value.end=e)},null,8,["value"]),(0,l.bF)(s,{type:"primary",onClick:i[3]||(i[3]=e=>D())},{default:(0,l.k6)((()=>[(0,l.eW)("查询")])),_:1})])),_:1})]),(0,l.bF)(H,{dataSource:r.value,onResizeColumn:M,onChange:j,columns:V,pagination:o.value,loading:(0,d.R1)(Q)},{bodyCell:(0,l.k6)((({column:e,record:a})=>["operation"===e.dataIndex?((0,l.uX)(),(0,l.Wv)(s,{key:0,danger:"",type:"primary",onClick:e=>Y(a)},{default:(0,l.k6)((()=>[(0,l.eW)("预订")])),_:2},1032,["onClick"])):(0,l.Q3)("",!0),"ydz"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[a.ydz>=0?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",b,(0,n.v_)(a.ydz)+"张",1),(0,l.Lk)("div",m,"￥ "+(0,n.v_)(a.ydzPrice),1)])):((0,l.uX)(),(0,l.CE)("div",k," -- "))],64)):(0,l.Q3)("",!0),"start"===e.dataIndex?((0,l.uX)(),(0,l.CE)("div",w,[(0,l.Lk)("div",null,(0,n.v_)(a.start),1),g,(0,l.Lk)("div",null,(0,n.v_)(a.end),1)])):(0,l.Q3)("",!0),"startTime"===e.dataIndex?((0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",null,(0,n.v_)(a.startTime),1),_,(0,l.Lk)("div",null,(0,n.v_)(a.endTime),1)])):(0,l.Q3)("",!0),"edz"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:4},[a.edz>=0?((0,l.uX)(),(0,l.CE)("div",F,[(0,l.Lk)("div",x,[(0,l.eW)((0,n.v_)(a.edz)+"张",1),h]),(0,l.Lk)("div",S,"￥ "+(0,n.v_)(a.edzPrice),1)])):((0,l.uX)(),(0,l.CE)("div",f))],64)):(0,l.Q3)("",!0),"yw"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:5},[a.yw>=0?((0,l.uX)(),(0,l.CE)("div",z,[(0,l.Lk)("div",I,(0,n.v_)(a.yw)+"张",1),C,(0,l.Lk)("div",E,"￥ "+(0,n.v_)(a.ywPrice),1)])):((0,l.uX)(),(0,l.CE)("div",P," -- "))],64)):(0,l.Q3)("",!0),"time"===e.dataIndex?((0,l.uX)(),(0,l.CE)("div",T,[(0,l.Lk)("div",null,(0,n.v_)(a.time),1),a.startTime<a.endTime?((0,l.uX)(),(0,l.CE)("div",L,"当日到达")):((0,l.uX)(),(0,l.CE)("div",U,"次日到达"))])):(0,l.Q3)("",!0),"rw"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:7},[a.rw>=0?((0,l.uX)(),(0,l.CE)("div",A,[(0,l.Lk)("div",N,(0,n.v_)(a.rw)+"张",1),(0,l.Lk)("div",X,"￥ "+(0,n.v_)(a.rwPrice),1),K])):((0,l.uX)(),(0,l.CE)("div",O," -- "))],64)):(0,l.Q3)("",!0)])),_:1},8,["dataSource","pagination","loading"])]),(0,l.bF)($,{visible:a.value,"onUpdate:visible":i[22]||(i[22]=e=>a.value=e),title:"余票信息",onOk:e.handleOk,"ok-text":"确认","cancel-text":"取消"},{default:(0,l.k6)((()=>[(0,l.bF)(Z,{model:(0,d.R1)(t),"label-col":{span:4},"wrapper-col":{span:20}},{default:(0,l.k6)((()=>[(0,l.bF)(B,{label:"日期"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{value:(0,d.R1)(t).date,"onUpdate:value":i[4]||(i[4]=e=>(0,d.R1)(t).date=e),valueFormat:"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"车次编号"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).trainCode,"onUpdate:value":i[5]||(i[5]=e=>(0,d.R1)(t).trainCode=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"出发站"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).start,"onUpdate:value":i[6]||(i[6]=e=>(0,d.R1)(t).start=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"出发站拼音"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).startPinyin,"onUpdate:value":i[7]||(i[7]=e=>(0,d.R1)(t).startPinyin=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"出发时间"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{value:(0,d.R1)(t).startTime,"onUpdate:value":i[8]||(i[8]=e=>(0,d.R1)(t).startTime=e),valueFormat:"HH:mm:ss",placeholder:"请选择时间"},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"出发站序"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).startIndex,"onUpdate:value":i[9]||(i[9]=e=>(0,d.R1)(t).startIndex=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"到达站"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).end,"onUpdate:value":i[10]||(i[10]=e=>(0,d.R1)(t).end=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"到达站拼音"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).endPinyin,"onUpdate:value":i[11]||(i[11]=e=>(0,d.R1)(t).endPinyin=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"到站时间"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{value:(0,d.R1)(t).endTime,"onUpdate:value":i[12]||(i[12]=e=>(0,d.R1)(t).endTime=e),valueFormat:"HH:mm:ss",placeholder:"请选择时间"},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"到站站序"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).endIndex,"onUpdate:value":i[13]||(i[13]=e=>(0,d.R1)(t).endIndex=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"一等座余票"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).ydz,"onUpdate:value":i[14]||(i[14]=e=>(0,d.R1)(t).ydz=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"一等座票价"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).ydzPrice,"onUpdate:value":i[15]||(i[15]=e=>(0,d.R1)(t).ydzPrice=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"二等座余票"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).edz,"onUpdate:value":i[16]||(i[16]=e=>(0,d.R1)(t).edz=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"二等座票价"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).edzPrice,"onUpdate:value":i[17]||(i[17]=e=>(0,d.R1)(t).edzPrice=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"软卧余票"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).rw,"onUpdate:value":i[18]||(i[18]=e=>(0,d.R1)(t).rw=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"软卧票价"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).rwPrice,"onUpdate:value":i[19]||(i[19]=e=>(0,d.R1)(t).rwPrice=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"硬卧余票"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).yw,"onUpdate:value":i[20]||(i[20]=e=>(0,d.R1)(t).yw=e)},null,8,["value"])])),_:1}),(0,l.bF)(B,{label:"硬卧票价"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{value:(0,d.R1)(t).ywPrice,"onUpdate:value":i[21]||(i[21]=e=>(0,d.R1)(t).ywPrice=e)},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","onOk"])],64)}}};const Q=M;var V=Q}}]);
//# sourceMappingURL=199.16dfbb8f.js.map